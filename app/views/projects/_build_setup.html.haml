%hr
%fieldset#build_setup
  %h3 Build Setup
  .form-group
    = f.label :webhooks_enabled, 'Payload Strategy', class: 'col-sm-2 control-label'
    .col-sm-10
      .radio.row
        = f.label :webhooks_enabled_true do
          .col-sm-1
            = f.radio_button :webhooks_enabled, true
            Webhooks
          .col-sm-10.col-sm-offset-1
            %span#webhook_url.text-muted= project_webhooks_url(f.object)
      .radio
        = f.label :webhooks_enabled_false do
          = f.radio_button :webhooks_enabled, false
          Polling
  .form-group#branch_name{ class: f.object.requires_branch_name? ? nil : 'hide' }
    = f.label :build_branch, 'Branch Name', class: 'col-sm-2 control-label'
    .col-sm-4
      = f.text_field :build_branch, class: 'form-control'
    %p.help-block Default is 'master'. Codeship projects can utilize regex matching.
  #field_container
    - ProjectsHelper::PROJECT_TYPE_NAMES.each do |project_type|
      - enabled = f.object.type == project_type.name
      .project-attributes{ id: project_type,  class: "#{'hide' unless enabled}" }
        - project_specific_attributes_for(project_type).each do |field, field_attributes|
          .form-group
            = f.label field, field_attributes.label, class: 'col-sm-2 control-label'
            .col-sm-4
              = f.text_field field, disabled: !enabled, class: 'form-control'
            - if field_attributes.tooltip
              %p.help-block= field_attributes.tooltip
  %fieldset#polling
    .form-group.auth_field
      = f.label :auth_username, 'Feed Username', class: 'col-sm-2 control-label'
      .col-sm-4
        = f.text_field :auth_username, size: 40, class: 'optional form-control', autocomplete: 'off'
      %p.help-block Basic or digest authentication
    .form-group.auth_field
      = f.label :auth_password, 'Feed Password', class: 'col-sm-2 control-label'
      .col-sm-4
        %input{ id: 'password_changed', name: 'password_changed', type: 'hidden', value: 'false' }
        = f.password_field :auth_password, class: 'form-control', disabled: true
      %p.help-block
        - if f.object.auth_password.present?
          %span.label.label-success Saved
        - else
          %span.label.label-default Not Set
        %button{id: 'change_password', class: 'button-link'} Change password
    .form-group
      = f.label :online, 'CI status', class: 'col-sm-2 control-label'
      = f.hidden_field :online
      .col-sm-4
        %p.help-block#build_status
          %span.label.label-success.success.hide OK
          %span.label.label-info.pending.hide Loading...
          %span.label.label-default.unconfigured.hide Unconfigured
          %span.label.label-danger.failure.hide Error
          %span.label.label-warning.empty_fields.hide Some Fields Empty
          &nbsp;
          %input{ class: 'refresh btn btn-default btn-xs', type: 'button', value: 'Refresh' }
          %span{:class => 'error-message hide'}
    .row
      .col-sm-offset-2.col-sm-10
        %p.text-muted= project_refreshed_at(f.object)

